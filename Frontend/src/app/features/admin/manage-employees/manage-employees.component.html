<div class="page-header">
  <h2>Manage Employees</h2>
  <button class="btn-add" (click)="openAddModal()">
    <i class="fa-solid fa-plus"></i> Add Employee
  </button>

  <div class="search-bar">
    <input type="number" placeholder="Search ID..." [(ngModel)]="searchId">
    <button class="btn-search" (click)="searchEmployee()">
      <i class="fa-solid fa-magnifying-glass"></i>
    </button>
    @if (isSearching) {
      <button class="btn-reset" (click)="resetSearch()">
        <i class="fa-solid fa-rotate-left"></i> Reset
      </button>
    }
  </div>
</div>

@if (isLoading) {
  <div class="loading-state">Loading...</div>
} @else {
  <div class="table-container">
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>Name</th>
          <th>Email</th>
          <th>Role</th>
          <th>Hotel</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        @for (emp of employees; track emp.id) {
          <tr>
            <td>#{{ emp.id }}</td>
            <td class="fw-bold">{{ emp.fullName }}</td>
            <td>{{ emp.email }}</td>
            <td>
              <span class="role-badge">{{ emp.role }}</span>
            </td>
            <td>{{ emp.hotelName }}</td>
            <td>
              <div class="action-buttons">
                <button class="btn-icon edit" (click)="openEditModal(emp)">
                  <i class="fa-solid fa-pen"></i>
                </button>
                <button class="btn-icon delete" (click)="deleteEmployee(emp.id)">
                  <i class="fa-solid fa-trash"></i>
                </button>
              </div>
            </td>
          </tr>
        }
      </tbody>
    </table>
    @if (employees.length === 0) {
      <div class="empty-state">
        No employees found. Click "Add Employee" to create one.
      </div>
    }
  </div>
}

@if (showModal) {
  <div class="modal-overlay">
    <div class="modal-card">
      <div class="modal-header">
        <h3>{{ isEditing ? 'Edit Employee' : 'Add New Employee' }}</h3>
        <button class="btn-close" (click)="closeModal()"><i class="fa-solid fa-xmark"></i></button>
      </div>

      <form (ngSubmit)="empForm.form.valid && saveEmployee()" #empForm="ngForm">

        <div class="form-group">
          <label>Full Name <span class="text-danger">*</span></label>
          <input type="text" [(ngModel)]="currentEmployee.fullName" name="fullName" required>
        </div>

        <div class="form-group">
          <label>Email <span class="text-danger">*</span></label>
          <input type="email" [(ngModel)]="currentEmployee.email" name="email" required email>
        </div>

        <div class="row">
          <div class="col form-group">
            <label>Role <span class="text-danger">*</span></label>
            <input type="text" [(ngModel)]="currentEmployee.role" name="role" required placeholder="e.g. Manager">
          </div>
          <div class="col form-group">
            <label>Hotel <span class="text-danger">*</span></label>
            <select [(ngModel)]="currentEmployee.hotelClassId" name="hotelClassId" required>
              <option [ngValue]="null" disabled>Select Hotel</option>
              @for (h of hotels; track h.id) {
                <option [ngValue]="h.id">{{ h.name }}</option>
              }
            </select>
          </div>
        </div>

        <div class="modal-footer">
          <button type="button" class="btn-cancel" (click)="closeModal()">Cancel</button>
          <button type="submit" class="btn-save" [disabled]="empForm.invalid">Save Employee</button>
        </div>
      </form>
    </div>
  </div>
}
